

trainOrTest = false;
expType = 'subspeci';
dataSet = 1;
expID = 1;

    filename = 'testdata.xlsx';
    
    if exist(filename, 'file') == 0
        col_header={'ID','Dataset','Dataset Size','expType','Target Size',...
            'numLayers','Layer1Size','Layer1Fcn','Layer2Size','Layer2Fcn',...
            'Layer3Size','Layer3Fcn','Layer4Size','Layer4Fnc','trainFcn',...
            'lr','lr_inc','lr_dec','mc','divideFcn','trainRatio','trainVal',...
            'testRatio','num_epochs','best_epoch','time','best_perf','best_vperf','best_tperf','accuracyPred','accuracyTest'}; 
    
        xlswrite(filename,col_header)
    end

    numL = net.numLayers;
    tLayerFcn = "";
    tLayerSize = zeros(4)
    for i = 1 : numL
        tLayerFcn(i)  = net.layers{i}.transferFcn;
        tLayerSize(i) = net.layers{i}.size;
    end
    
    data = [expID,dataSet, size(dataSet,2), {expType}, size(dataTarget,1), net.numLayers,...
            checkLayerFcn(net,1), tLayerSize(1),checkLayerFcn(net,2), tLayerSize(2),checkLayerFcn(net,3), tLayerSize(3),...
            checkLayerFcn(net,4), tLayerSize(4),{tr.trainFcn}, tr.trainParam.lr, tr.trainParam.lr_inc, tr.trainParam.lr_dec,...
            tr.trainParam.mc, {tr.divideFcn},tr.divideParam.trainRatio, tr.divideParam.valRatio, tr.divideParam.testRatio,...
            tr.num_epochs, ];
    
    disp(data)

    if trainOrTest
        
        accuracyPred
        accuracyTest
    end

% disp(tr.trainFcn)
% disp(tr.trainParam)
% disp(tr.performFcn)
% disp(tr.divideFcn)
% disp(tr.divideParam)
% 
% disp(tr.num_epochs)
% disp(tr.best_epoch)
% disp(tr.time(tr.num_epochs))
% disp(tr.best_perf)
% disp(tr.best_vperf)
% disp(tr.best_tperf)
% 

function val = checkLayerFcn(net, index)
        
    if index <= net.numLayers
       val = net.layers{index}.transferFcn
    else
        val= 'none';
    end
end